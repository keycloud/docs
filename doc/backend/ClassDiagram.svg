<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="761px" preserveAspectRatio="none" style="width:2108px;height:761px;" version="1.1" viewBox="0 0 2108 761" width="2108px" zoomAndPan="magnify"><defs><filter height="300%" id="f1pxjiugddcy9e" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[a70b0d373322012744ecc119c63f921b]
cluster main--><polygon fill="#FFFFFF" filter="url(#f1pxjiugddcy9e)" points="22,24,65,24,72,46.2969,2086,46.2969,2086,749,22,749,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="72" y1="46.2969" y2="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="26" y="38.9951">main</text><!--MD5=[910db1ec931a62c085019de4e76fce18]
class main.Authenticator--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="188.8516" id="main.Authenticator" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="490.5" y="78"/><ellipse cx="536.75" cy="94" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M541.0313,89.9688 L541.0313,91.4688 C541.0313,91.9375 541,92.0781 540.8906,92.25 C540.7188,92.4688 540.4688,92.6094 540.2031,92.6094 C539.9688,92.6094 539.7344,92.5 539.5938,92.375 C539.4688,92.2344 539.4688,92.2344 539.3594,91.6875 C539.2031,91.0156 538.3906,90.5469 537.3281,90.5469 C536.2656,90.5469 535.4063,91.1094 535.4063,91.8438 C535.4063,92.2031 535.6719,92.5938 536.0469,92.7813 C536.375,92.9531 536.4688,92.9844 537.7344,93.2188 C539.2188,93.4844 539.8594,93.7344 540.3906,94.1563 C541.0781,94.7031 541.3906,95.3906 541.3906,96.2813 C541.3906,98.0469 539.8281,99.2344 537.5,99.2344 C536.5781,99.2344 535.6875,99.0156 534.8438,98.5781 C534.5625,98.9219 534.4375,98.9844 534.1719,98.9844 C533.5781,98.9844 533.2969,98.625 533.2969,97.8594 L533.2969,96.7344 C533.2969,96.3125 533.3438,96.125 533.4531,95.9531 C533.625,95.7344 533.875,95.6094 534.1563,95.6094 C534.3906,95.6094 534.6094,95.7031 534.7656,95.8594 C534.8906,95.9688 534.8906,95.9688 535.0156,96.4375 C535.1875,97.0469 536.2656,97.5313 537.3906,97.5313 C538.6406,97.5313 539.625,96.9844 539.625,96.25 C539.625,95.8906 539.3906,95.5469 539.0156,95.3438 C538.6563,95.1563 538.3906,95.0938 537.2344,94.8906 C536.125,94.7031 535.5781,94.5313 535.0313,94.2188 C534.1719,93.7344 533.6406,92.8281 533.6406,91.8594 C533.6406,90.1406 535.2188,88.8438 537.3281,88.8438 C538.2031,88.8438 538.9531,89.0313 539.5469,89.4063 C539.7188,88.9844 539.8594,88.8438 540.2031,88.8438 C540.5,88.8438 540.7813,89 540.9219,89.2344 C541.0156,89.3906 541.0313,89.5313 541.0313,89.9688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="557.25" y="98.1543">Authenticator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="491.5" x2="676.5" y1="110" y2="110"/><ellipse cx="501.5" cy="121" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="510.5" y="124.2104">User *User</text><ellipse cx="501.5" cy="133.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="510.5" y="137.0151">ID []byte</text><ellipse cx="501.5" cy="146.6094" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="105" x="510.5" y="149.8198">CredentialID []byte</text><ellipse cx="501.5" cy="159.4141" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="510.5" y="162.6245">PublicKey []byte</text><ellipse cx="501.5" cy="172.2188" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="510.5" y="175.4292">AAGUID []byte</text><ellipse cx="501.5" cy="185.0234" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="510.5" y="188.2339">SignCount uint32</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="491.5" x2="676.5" y1="194.8281" y2="194.8281"/><ellipse cx="501.5" cy="205.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="510.5" y="209.0386">WebAuthID() []byte</text><ellipse cx="501.5" cy="218.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="510.5" y="221.8433">WebAuthCredentialID() []byte</text><ellipse cx="501.5" cy="231.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="510.5" y="234.6479">WebAuthPublicKey() []byte</text><ellipse cx="501.5" cy="244.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="510.5" y="247.4526">WebAuthAAGUID() []byte</text><ellipse cx="501.5" cy="257.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="510.5" y="260.2573">WebAuthSignCount() uint32</text><!--MD5=[cbc57865e458ecd403cbf1137991ba9e]
class main.AuthnHandler--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="227.2656" id="main.AuthnHandler" style="stroke: #A80036; stroke-width: 1.5;" width="419" x="712.5" y="59"/><ellipse cx="874.75" cy="75" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M879.0313,70.9688 L879.0313,72.4688 C879.0313,72.9375 879,73.0781 878.8906,73.25 C878.7188,73.4688 878.4688,73.6094 878.2031,73.6094 C877.9688,73.6094 877.7344,73.5 877.5938,73.375 C877.4688,73.2344 877.4688,73.2344 877.3594,72.6875 C877.2031,72.0156 876.3906,71.5469 875.3281,71.5469 C874.2656,71.5469 873.4063,72.1094 873.4063,72.8438 C873.4063,73.2031 873.6719,73.5938 874.0469,73.7813 C874.375,73.9531 874.4688,73.9844 875.7344,74.2188 C877.2188,74.4844 877.8594,74.7344 878.3906,75.1563 C879.0781,75.7031 879.3906,76.3906 879.3906,77.2813 C879.3906,79.0469 877.8281,80.2344 875.5,80.2344 C874.5781,80.2344 873.6875,80.0156 872.8438,79.5781 C872.5625,79.9219 872.4375,79.9844 872.1719,79.9844 C871.5781,79.9844 871.2969,79.625 871.2969,78.8594 L871.2969,77.7344 C871.2969,77.3125 871.3438,77.125 871.4531,76.9531 C871.625,76.7344 871.875,76.6094 872.1563,76.6094 C872.3906,76.6094 872.6094,76.7031 872.7656,76.8594 C872.8906,76.9688 872.8906,76.9688 873.0156,77.4375 C873.1875,78.0469 874.2656,78.5313 875.3906,78.5313 C876.6406,78.5313 877.625,77.9844 877.625,77.25 C877.625,76.8906 877.3906,76.5469 877.0156,76.3438 C876.6563,76.1563 876.3906,76.0938 875.2344,75.8906 C874.125,75.7031 873.5781,75.5313 873.0313,75.2188 C872.1719,74.7344 871.6406,73.8281 871.6406,72.8594 C871.6406,71.1406 873.2188,69.8438 875.3281,69.8438 C876.2031,69.8438 876.9531,70.0313 877.5469,70.4063 C877.7188,69.9844 877.8594,69.8438 878.2031,69.8438 C878.5,69.8438 878.7813,70 878.9219,70.2344 C879.0156,70.3906 879.0313,70.5313 879.0313,70.9688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="895.25" y="79.1543">AuthnHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="713.5" x2="1130.5" y1="91" y2="91"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="99"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="115" x="732.5" y="105.2104">sessionName string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="111.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="156" x="732.5" y="118.0151">authn *webauthn.WebAuthn</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="124.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="202" x="732.5" y="130.8198">cookieStore *sessions.CookieStore</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="137.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="143" x="732.5" y="143.6245">storage StorageInterface</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="150.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="732.5" y="156.4292">securityTokenName string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="163.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="122" x="732.5" y="169.2339">userFieldName string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="175.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="732.5" y="182.0386">cookieSessionName string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="713.5" x2="1130.5" y1="188.6328" y2="188.6328"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="196.6328"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="389" x="732.5" y="202.8433">startRegistration(writer http.ResponseWriter, request *http.Request)</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="209.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="393" x="732.5" y="215.6479">finishRegistration(writer http.ResponseWriter, request *http.Request)</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="222.2422"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="351" x="732.5" y="228.4526">startLogin(writer http.ResponseWriter, request *http.Request)</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="235.0469"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="355" x="732.5" y="241.2573">finishLogin(writer http.ResponseWriter, request *http.Request)</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="247.8516"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="375" x="732.5" y="254.062">standardLogin(writer http.ResponseWriter, request *http.Request)</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="260.6563"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="392" x="732.5" y="266.8667">standardRegister(writer http.ResponseWriter, request *http.Request)</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="720.5" y="273.4609"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="329" x="732.5" y="279.6714">logout(writer http.ResponseWriter, request *http.Request)</text><!--MD5=[f92b51f0f07aa89026d294616c40aa4c]
class main.CRUDHandler--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="150.4375" id="main.CRUDHandler" style="stroke: #A80036; stroke-width: 1.5;" width="421" x="1166.5" y="97.5"/><ellipse cx="1331.25" cy="113.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1335.5313,109.4688 L1335.5313,110.9688 C1335.5313,111.4375 1335.5,111.5781 1335.3906,111.75 C1335.2188,111.9688 1334.9688,112.1094 1334.7031,112.1094 C1334.4688,112.1094 1334.2344,112 1334.0938,111.875 C1333.9688,111.7344 1333.9688,111.7344 1333.8594,111.1875 C1333.7031,110.5156 1332.8906,110.0469 1331.8281,110.0469 C1330.7656,110.0469 1329.9063,110.6094 1329.9063,111.3438 C1329.9063,111.7031 1330.1719,112.0938 1330.5469,112.2813 C1330.875,112.4531 1330.9688,112.4844 1332.2344,112.7188 C1333.7188,112.9844 1334.3594,113.2344 1334.8906,113.6563 C1335.5781,114.2031 1335.8906,114.8906 1335.8906,115.7813 C1335.8906,117.5469 1334.3281,118.7344 1332,118.7344 C1331.0781,118.7344 1330.1875,118.5156 1329.3438,118.0781 C1329.0625,118.4219 1328.9375,118.4844 1328.6719,118.4844 C1328.0781,118.4844 1327.7969,118.125 1327.7969,117.3594 L1327.7969,116.2344 C1327.7969,115.8125 1327.8438,115.625 1327.9531,115.4531 C1328.125,115.2344 1328.375,115.1094 1328.6563,115.1094 C1328.8906,115.1094 1329.1094,115.2031 1329.2656,115.3594 C1329.3906,115.4688 1329.3906,115.4688 1329.5156,115.9375 C1329.6875,116.5469 1330.7656,117.0313 1331.8906,117.0313 C1333.1406,117.0313 1334.125,116.4844 1334.125,115.75 C1334.125,115.3906 1333.8906,115.0469 1333.5156,114.8438 C1333.1563,114.6563 1332.8906,114.5938 1331.7344,114.3906 C1330.625,114.2031 1330.0781,114.0313 1329.5313,113.7188 C1328.6719,113.2344 1328.1406,112.3281 1328.1406,111.3594 C1328.1406,109.6406 1329.7188,108.3438 1331.8281,108.3438 C1332.7031,108.3438 1333.4531,108.5313 1334.0469,108.9063 C1334.2188,108.4844 1334.3594,108.3438 1334.7031,108.3438 C1335,108.3438 1335.2813,108.5 1335.4219,108.7344 C1335.5156,108.8906 1335.5313,109.0313 1335.5313,109.4688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="83" x="1351.75" y="117.6543">CRUDHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1167.5" x2="1586.5" y1="129.5" y2="129.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1174.5" y="137.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="202" x="1186.5" y="143.7104">cookieStore *sessions.CookieStore</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1174.5" y="150.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="143" x="1186.5" y="156.5151">storage StorageInterface</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1167.5" x2="1586.5" y1="163.1094" y2="163.1094"/><ellipse cx="1177.5" cy="174.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="370" x="1186.5" y="177.3198">GetPassword(writer http.ResponseWriter, request *http.Request)</text><ellipse cx="1177.5" cy="186.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="371" x="1186.5" y="190.1245">AddPassword(writer http.ResponseWriter, request *http.Request)</text><ellipse cx="1177.5" cy="199.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="395" x="1186.5" y="202.9292">RemovePassword(writer http.ResponseWriter, request *http.Request)</text><ellipse cx="1177.5" cy="212.5234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="366" x="1186.5" y="215.7339">RemoveUser(writer http.ResponseWriter, request *http.Request)</text><ellipse cx="1177.5" cy="225.3281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="361" x="1186.5" y="228.5386">UpdateUser(writer http.ResponseWriter, request *http.Request)</text><ellipse cx="1177.5" cy="238.1328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="341" x="1186.5" y="241.3433">GetUser(writer http.ResponseWriter, request *http.Request)</text><!--MD5=[1063575ef2245d8cfce3140560fd16a4]
class main.FileServer--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="163.2422" id="main.FileServer" style="stroke: #A80036; stroke-width: 1.5;" width="447" x="1622.5" y="91"/><ellipse cx="1811.25" cy="107" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1815.5313,102.9688 L1815.5313,104.4688 C1815.5313,104.9375 1815.5,105.0781 1815.3906,105.25 C1815.2188,105.4688 1814.9688,105.6094 1814.7031,105.6094 C1814.4688,105.6094 1814.2344,105.5 1814.0938,105.375 C1813.9688,105.2344 1813.9688,105.2344 1813.8594,104.6875 C1813.7031,104.0156 1812.8906,103.5469 1811.8281,103.5469 C1810.7656,103.5469 1809.9063,104.1094 1809.9063,104.8438 C1809.9063,105.2031 1810.1719,105.5938 1810.5469,105.7813 C1810.875,105.9531 1810.9688,105.9844 1812.2344,106.2188 C1813.7188,106.4844 1814.3594,106.7344 1814.8906,107.1563 C1815.5781,107.7031 1815.8906,108.3906 1815.8906,109.2813 C1815.8906,111.0469 1814.3281,112.2344 1812,112.2344 C1811.0781,112.2344 1810.1875,112.0156 1809.3438,111.5781 C1809.0625,111.9219 1808.9375,111.9844 1808.6719,111.9844 C1808.0781,111.9844 1807.7969,111.625 1807.7969,110.8594 L1807.7969,109.7344 C1807.7969,109.3125 1807.8438,109.125 1807.9531,108.9531 C1808.125,108.7344 1808.375,108.6094 1808.6563,108.6094 C1808.8906,108.6094 1809.1094,108.7031 1809.2656,108.8594 C1809.3906,108.9688 1809.3906,108.9688 1809.5156,109.4375 C1809.6875,110.0469 1810.7656,110.5313 1811.8906,110.5313 C1813.1406,110.5313 1814.125,109.9844 1814.125,109.25 C1814.125,108.8906 1813.8906,108.5469 1813.5156,108.3438 C1813.1563,108.1563 1812.8906,108.0938 1811.7344,107.8906 C1810.625,107.7031 1810.0781,107.5313 1809.5313,107.2188 C1808.6719,106.7344 1808.1406,105.8281 1808.1406,104.8594 C1808.1406,103.1406 1809.7188,101.8438 1811.8281,101.8438 C1812.7031,101.8438 1813.4531,102.0313 1814.0469,102.4063 C1814.2188,101.9844 1814.3594,101.8438 1814.7031,101.8438 C1815,101.8438 1815.2813,102 1815.4219,102.2344 C1815.5156,102.3906 1815.5313,102.5313 1815.5313,102.9688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="61" x="1831.75" y="111.1543">FileServer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1623.5" x2="2068.5" y1="123" y2="123"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1630.5" y="131"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="1642.5" y="137.2104">baseDir string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1630.5" y="143.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="202" x="1642.5" y="150.0151">cookieStore *sessions.CookieStore</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1630.5" y="156.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="115" x="1642.5" y="162.8198">sessionName string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1630.5" y="169.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="1642.5" y="175.6245">cookieName string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1630.5" y="182.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1642.5" y="188.4292">storage *Storage</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1630.5" y="195.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="122" x="1642.5" y="201.2339">userFieldName string</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1646.5" y="214.0386"/><ellipse cx="1633.5" cy="223.6328" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="112" x="1642.5" y="226.8433">Router *mux.Router</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1623.5" x2="2068.5" y1="233.4375" y2="233.4375"/><ellipse cx="1633.5" cy="244.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="421" x="1642.5" y="247.6479">ServeFileWithoutCheck(writer http.ResponseWriter, request *http.Request)</text><!--MD5=[6398aa18878d89809cfcee7fa1395a00]
class main.GetPasswordRequest--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="60.8047" id="main.GetPasswordRequest" style="stroke: #A80036; stroke-width: 1.5;" width="169" x="573.5" y="442"/><ellipse cx="589.85" cy="458" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M594.1313,453.9688 L594.1313,455.4688 C594.1313,455.9375 594.1,456.0781 593.9906,456.25 C593.8188,456.4688 593.5688,456.6094 593.3031,456.6094 C593.0688,456.6094 592.8344,456.5 592.6938,456.375 C592.5688,456.2344 592.5688,456.2344 592.4594,455.6875 C592.3031,455.0156 591.4906,454.5469 590.4281,454.5469 C589.3656,454.5469 588.5063,455.1094 588.5063,455.8438 C588.5063,456.2031 588.7719,456.5938 589.1469,456.7813 C589.475,456.9531 589.5688,456.9844 590.8344,457.2188 C592.3188,457.4844 592.9594,457.7344 593.4906,458.1563 C594.1781,458.7031 594.4906,459.3906 594.4906,460.2813 C594.4906,462.0469 592.9281,463.2344 590.6,463.2344 C589.6781,463.2344 588.7875,463.0156 587.9438,462.5781 C587.6625,462.9219 587.5375,462.9844 587.2719,462.9844 C586.6781,462.9844 586.3969,462.625 586.3969,461.8594 L586.3969,460.7344 C586.3969,460.3125 586.4438,460.125 586.5531,459.9531 C586.725,459.7344 586.975,459.6094 587.2563,459.6094 C587.4906,459.6094 587.7094,459.7031 587.8656,459.8594 C587.9906,459.9688 587.9906,459.9688 588.1156,460.4375 C588.2875,461.0469 589.3656,461.5313 590.4906,461.5313 C591.7406,461.5313 592.725,460.9844 592.725,460.25 C592.725,459.8906 592.4906,459.5469 592.1156,459.3438 C591.7563,459.1563 591.4906,459.0938 590.3344,458.8906 C589.225,458.7031 588.6781,458.5313 588.1313,458.2188 C587.2719,457.7344 586.7406,456.8281 586.7406,455.8594 C586.7406,454.1406 588.3188,452.8438 590.4281,452.8438 C591.3031,452.8438 592.0531,453.0313 592.6469,453.4063 C592.8188,452.9844 592.9594,452.8438 593.3031,452.8438 C593.6,452.8438 593.8813,453 594.0219,453.2344 C594.1156,453.3906 594.1313,453.5313 594.1313,453.9688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="134" x="604.15" y="462.1543">GetPasswordRequest</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="574.5" x2="741.5" y1="474" y2="474"/><ellipse cx="584.5" cy="485" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="143" x="593.5" y="488.2104">PasswordIdentifier string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="574.5" x2="741.5" y1="494.8047" y2="494.8047"/><!--MD5=[60832684c9bb2f9b01b93c350d753c5a]
class main.Password--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="73.6094" id="main.Password" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="777.5" y="435.5"/><ellipse cx="804.65" cy="451.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M808.9313,447.4688 L808.9313,448.9688 C808.9313,449.4375 808.9,449.5781 808.7906,449.75 C808.6188,449.9688 808.3688,450.1094 808.1031,450.1094 C807.8688,450.1094 807.6344,450 807.4938,449.875 C807.3688,449.7344 807.3688,449.7344 807.2594,449.1875 C807.1031,448.5156 806.2906,448.0469 805.2281,448.0469 C804.1656,448.0469 803.3063,448.6094 803.3063,449.3438 C803.3063,449.7031 803.5719,450.0938 803.9469,450.2813 C804.275,450.4531 804.3688,450.4844 805.6344,450.7188 C807.1188,450.9844 807.7594,451.2344 808.2906,451.6563 C808.9781,452.2031 809.2906,452.8906 809.2906,453.7813 C809.2906,455.5469 807.7281,456.7344 805.4,456.7344 C804.4781,456.7344 803.5875,456.5156 802.7438,456.0781 C802.4625,456.4219 802.3375,456.4844 802.0719,456.4844 C801.4781,456.4844 801.1969,456.125 801.1969,455.3594 L801.1969,454.2344 C801.1969,453.8125 801.2438,453.625 801.3531,453.4531 C801.525,453.2344 801.775,453.1094 802.0563,453.1094 C802.2906,453.1094 802.5094,453.2031 802.6656,453.3594 C802.7906,453.4688 802.7906,453.4688 802.9156,453.9375 C803.0875,454.5469 804.1656,455.0313 805.2906,455.0313 C806.5406,455.0313 807.525,454.4844 807.525,453.75 C807.525,453.3906 807.2906,453.0469 806.9156,452.8438 C806.5563,452.6563 806.2906,452.5938 805.1344,452.3906 C804.025,452.2031 803.4781,452.0313 802.9313,451.7188 C802.0719,451.2344 801.5406,450.3281 801.5406,449.3594 C801.5406,447.6406 803.1188,446.3438 805.2281,446.3438 C806.1031,446.3438 806.8531,446.5313 807.4469,446.9063 C807.6188,446.4844 807.7594,446.3438 808.1031,446.3438 C808.4,446.3438 808.6813,446.5 808.8219,446.7344 C808.9156,446.8906 808.9313,447.0313 808.9313,447.4688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="821.35" y="455.6543">Password</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="778.5" x2="895.5" y1="467.5" y2="467.5"/><ellipse cx="788.5" cy="478.5" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="797.5" y="481.7104">Password string</text><ellipse cx="788.5" cy="491.3047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="797.5" y="494.5151">Id string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="778.5" x2="895.5" y1="501.1094" y2="501.1094"/><!--MD5=[ef28d696a57cf20af52951f92e28bfa8]
class main.PasswordRequest--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="73.6094" id="main.PasswordRequest" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="932" y="435.5"/><ellipse cx="947" cy="451.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M951.2813,447.4688 L951.2813,448.9688 C951.2813,449.4375 951.25,449.5781 951.1406,449.75 C950.9688,449.9688 950.7188,450.1094 950.4531,450.1094 C950.2188,450.1094 949.9844,450 949.8438,449.875 C949.7188,449.7344 949.7188,449.7344 949.6094,449.1875 C949.4531,448.5156 948.6406,448.0469 947.5781,448.0469 C946.5156,448.0469 945.6563,448.6094 945.6563,449.3438 C945.6563,449.7031 945.9219,450.0938 946.2969,450.2813 C946.625,450.4531 946.7188,450.4844 947.9844,450.7188 C949.4688,450.9844 950.1094,451.2344 950.6406,451.6563 C951.3281,452.2031 951.6406,452.8906 951.6406,453.7813 C951.6406,455.5469 950.0781,456.7344 947.75,456.7344 C946.8281,456.7344 945.9375,456.5156 945.0938,456.0781 C944.8125,456.4219 944.6875,456.4844 944.4219,456.4844 C943.8281,456.4844 943.5469,456.125 943.5469,455.3594 L943.5469,454.2344 C943.5469,453.8125 943.5938,453.625 943.7031,453.4531 C943.875,453.2344 944.125,453.1094 944.4063,453.1094 C944.6406,453.1094 944.8594,453.2031 945.0156,453.3594 C945.1406,453.4688 945.1406,453.4688 945.2656,453.9375 C945.4375,454.5469 946.5156,455.0313 947.6406,455.0313 C948.8906,455.0313 949.875,454.4844 949.875,453.75 C949.875,453.3906 949.6406,453.0469 949.2656,452.8438 C948.9063,452.6563 948.6406,452.5938 947.4844,452.3906 C946.375,452.2031 945.8281,452.0313 945.2813,451.7188 C944.4219,451.2344 943.8906,450.3281 943.8906,449.3594 C943.8906,447.6406 945.4688,446.3438 947.5781,446.3438 C948.4531,446.3438 949.2031,446.5313 949.7969,446.9063 C949.9688,446.4844 950.1094,446.3438 950.4531,446.3438 C950.75,446.3438 951.0313,446.5 951.1719,446.7344 C951.2656,446.8906 951.2813,447.0313 951.2813,447.4688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="112" x="961" y="455.6543">PasswordRequest</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="933" x2="1075" y1="467.5" y2="467.5"/><ellipse cx="943" cy="478.5" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="952" y="481.7104">Password string</text><ellipse cx="943" cy="491.3047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="952" y="494.5151">Id string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="933" x2="1075" y1="501.1094" y2="501.1094"/><!--MD5=[8e05dfc5e7366a5d793b608004a40c87]
class main.Storage--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="252.875" id="main.Storage" style="stroke: #A80036; stroke-width: 1.5;" width="500" x="38" y="346"/><ellipse cx="258.75" cy="362" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M263.0313,357.9688 L263.0313,359.4688 C263.0313,359.9375 263,360.0781 262.8906,360.25 C262.7188,360.4688 262.4688,360.6094 262.2031,360.6094 C261.9688,360.6094 261.7344,360.5 261.5938,360.375 C261.4688,360.2344 261.4688,360.2344 261.3594,359.6875 C261.2031,359.0156 260.3906,358.5469 259.3281,358.5469 C258.2656,358.5469 257.4063,359.1094 257.4063,359.8438 C257.4063,360.2031 257.6719,360.5938 258.0469,360.7813 C258.375,360.9531 258.4688,360.9844 259.7344,361.2188 C261.2188,361.4844 261.8594,361.7344 262.3906,362.1563 C263.0781,362.7031 263.3906,363.3906 263.3906,364.2813 C263.3906,366.0469 261.8281,367.2344 259.5,367.2344 C258.5781,367.2344 257.6875,367.0156 256.8438,366.5781 C256.5625,366.9219 256.4375,366.9844 256.1719,366.9844 C255.5781,366.9844 255.2969,366.625 255.2969,365.8594 L255.2969,364.7344 C255.2969,364.3125 255.3438,364.125 255.4531,363.9531 C255.625,363.7344 255.875,363.6094 256.1563,363.6094 C256.3906,363.6094 256.6094,363.7031 256.7656,363.8594 C256.8906,363.9688 256.8906,363.9688 257.0156,364.4375 C257.1875,365.0469 258.2656,365.5313 259.3906,365.5313 C260.6406,365.5313 261.625,364.9844 261.625,364.25 C261.625,363.8906 261.3906,363.5469 261.0156,363.3438 C260.6563,363.1563 260.3906,363.0938 259.2344,362.8906 C258.125,362.7031 257.5781,362.5313 257.0313,362.2188 C256.1719,361.7344 255.6406,360.8281 255.6406,359.8594 C255.6406,358.1406 257.2188,356.8438 259.3281,356.8438 C260.2031,356.8438 260.9531,357.0313 261.5469,357.4063 C261.7188,356.9844 261.8594,356.8438 262.2031,356.8438 C262.5,356.8438 262.7813,357 262.9219,357.2344 C263.0156,357.3906 263.0313,357.5313 263.0313,357.9688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="50" x="279.25" y="366.1543">Storage</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39" x2="537" y1="378" y2="378"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="386"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="58" y="392.2104">users</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="95" y="392.2104">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="74" x="120" y="392.2104">[string]*User</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="398.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="58" y="405.0151">authenticators</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="144" y="405.0151">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="122" x="169" y="405.0151">[string]*Authenticator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39" x2="537" y1="411.6094" y2="411.6094"/><ellipse cx="49" cy="422.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="474" x="58" y="425.8198">AddAuthenticator(user webauthn.User, authenticator webauthn.Authenticator) error</text><ellipse cx="49" cy="435.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="332" x="58" y="438.6245">GetAuthenticator(id []byte) (webauthn.Authenticator, error)</text><ellipse cx="49" cy="448.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="58" y="451.4292">GetUser(webauthnID string) *User</text><ellipse cx="49" cy="461.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="417" x="58" y="464.2339">GetAuthenticators(user webauthn.User) ([]webauthn.Authenticator, error)</text><ellipse cx="49" cy="473.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="238" x="58" y="477.0386">GetSessionKeyForUser(user *User) []byte</text><ellipse cx="49" cy="486.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="285" x="58" y="489.8433">SetSessionKeyForUser(user *User, b []byte) error</text><ellipse cx="49" cy="499.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="251" x="58" y="502.6479">DeleteSessionKeyForUser(user *User) error</text><ellipse cx="49" cy="512.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="58" y="515.4526">AddUser(u *User) error</text><ellipse cx="49" cy="525.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="58" y="528.2573">RemoveUser(u *User) error</text><ellipse cx="49" cy="537.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="58" y="541.062">UpdateUser(u *User) error</text><ellipse cx="49" cy="550.6563" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="299" x="58" y="553.8667">AddPassword(u *User, st string, p *Password) error</text><ellipse cx="49" cy="563.4609" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="295" x="58" y="566.6714">GetPassword(u *User, st string) (*Password, error)</text><ellipse cx="49" cy="576.2656" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="318" x="58" y="579.4761">UpdatePassword(u *User, st string, p *Password) error</text><ellipse cx="49" cy="589.0703" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="233" x="58" y="592.2808">DeletePassword(u *User, st string) error</text><!--MD5=[89535cb5052887f0e85347b75351a505]
class main.StorageInterface--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="227.2656" id="main.StorageInterface" style="stroke: #A80036; stroke-width: 1.5;" width="417" x="38.5" y="59"/><ellipse cx="189.25" cy="75" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M190.2031,71.7813 L190.2031,78.2969 L191.9219,78.2969 C192.375,78.2969 192.5156,78.3281 192.6875,78.4531 C192.9219,78.625 193.0313,78.875 193.0313,79.1563 C193.0313,79.7188 192.6719,80 191.9219,80 L186.7813,80 C186.375,80 186.1719,79.9531 186.0156,79.8281 C185.7969,79.6719 185.6563,79.4063 185.6563,79.1563 C185.6563,78.8594 185.8125,78.5781 186.0625,78.4219 C186.2188,78.3125 186.3438,78.2969 186.7813,78.2969 L188.5,78.2969 L188.5,71.7813 L186.7813,71.7813 C186.3594,71.7813 186.1719,71.75 186.0156,71.6406 C185.7969,71.4688 185.6563,71.2188 185.6563,70.9375 C185.6563,70.6563 185.8125,70.3594 186.0625,70.2031 C186.2188,70.1094 186.3438,70.0938 186.7813,70.0938 L191.9219,70.0938 C192.375,70.0938 192.5156,70.125 192.6875,70.2344 C192.9219,70.4063 193.0313,70.6719 193.0313,70.9375 C193.0313,71.2344 192.8906,71.5156 192.625,71.6719 C192.5,71.75 192.3125,71.7813 191.9219,71.7813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="107" x="209.75" y="79.1543">StorageInterface</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="454.5" y1="91" y2="91"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="454.5" y1="99" y2="99"/><ellipse cx="49.5" cy="110" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="373" x="58.5" y="113.2104">AddAuthenticator( webauthn.User,  webauthn.Authenticator) error</text><ellipse cx="49.5" cy="122.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="322" x="58.5" y="126.0151">GetAuthenticator( []byte) (webauthn.Authenticator, error)</text><ellipse cx="49.5" cy="135.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="391" x="58.5" y="138.8198">GetAuthenticators( webauthn.User) ([]webauthn.Authenticator, error)</text><ellipse cx="49.5" cy="148.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="58.5" y="151.6245">GetUser(webauthnID string) *User</text><ellipse cx="49.5" cy="161.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="58.5" y="164.4292">AddUser( *User) error</text><ellipse cx="49.5" cy="174.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="58.5" y="177.2339">RemoveUser( *User) error</text><ellipse cx="49.5" cy="186.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="58.5" y="190.0386">UpdateUser( *User) error</text><ellipse cx="49.5" cy="199.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="58.5" y="202.8433">GetSessionKeyForUser( *User) []byte</text><ellipse cx="49.5" cy="212.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="252" x="58.5" y="215.6479">SetSessionKeyForUser( *User,  []byte) error</text><ellipse cx="49.5" cy="225.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="225" x="58.5" y="228.4526">DeleteSessionKeyForUser( *User) error</text><ellipse cx="49.5" cy="238.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="277" x="58.5" y="241.2573">GetPassword( *User,  string) (*Password, error)</text><ellipse cx="49.5" cy="250.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="274" x="58.5" y="254.062">AddPassword( *User,  string,  *Password) error</text><ellipse cx="49.5" cy="263.6563" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="293" x="58.5" y="266.8667">UpdatePassword( *User,  string,  *Password) error</text><ellipse cx="49.5" cy="276.4609" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="215" x="58.5" y="279.6714">DeletePassword( *User,  string) error</text><!--MD5=[fb0d8f3de51a3f6a55c47e267c2b8a0d]
class main.User--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="124.8281" id="main.User" style="stroke: #A80036; stroke-width: 1.5;" width="259" x="1111.5" y="410"/><ellipse cx="1222.25" cy="426" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1226.5313,421.9688 L1226.5313,423.4688 C1226.5313,423.9375 1226.5,424.0781 1226.3906,424.25 C1226.2188,424.4688 1225.9688,424.6094 1225.7031,424.6094 C1225.4688,424.6094 1225.2344,424.5 1225.0938,424.375 C1224.9688,424.2344 1224.9688,424.2344 1224.8594,423.6875 C1224.7031,423.0156 1223.8906,422.5469 1222.8281,422.5469 C1221.7656,422.5469 1220.9063,423.1094 1220.9063,423.8438 C1220.9063,424.2031 1221.1719,424.5938 1221.5469,424.7813 C1221.875,424.9531 1221.9688,424.9844 1223.2344,425.2188 C1224.7188,425.4844 1225.3594,425.7344 1225.8906,426.1563 C1226.5781,426.7031 1226.8906,427.3906 1226.8906,428.2813 C1226.8906,430.0469 1225.3281,431.2344 1223,431.2344 C1222.0781,431.2344 1221.1875,431.0156 1220.3438,430.5781 C1220.0625,430.9219 1219.9375,430.9844 1219.6719,430.9844 C1219.0781,430.9844 1218.7969,430.625 1218.7969,429.8594 L1218.7969,428.7344 C1218.7969,428.3125 1218.8438,428.125 1218.9531,427.9531 C1219.125,427.7344 1219.375,427.6094 1219.6563,427.6094 C1219.8906,427.6094 1220.1094,427.7031 1220.2656,427.8594 C1220.3906,427.9688 1220.3906,427.9688 1220.5156,428.4375 C1220.6875,429.0469 1221.7656,429.5313 1222.8906,429.5313 C1224.1406,429.5313 1225.125,428.9844 1225.125,428.25 C1225.125,427.8906 1224.8906,427.5469 1224.5156,427.3438 C1224.1563,427.1563 1223.8906,427.0938 1222.7344,426.8906 C1221.625,426.7031 1221.0781,426.5313 1220.5313,426.2188 C1219.6719,425.7344 1219.1406,424.8281 1219.1406,423.8594 C1219.1406,422.1406 1220.7188,420.8438 1222.8281,420.8438 C1223.7031,420.8438 1224.4531,421.0313 1225.0469,421.4063 C1225.2188,420.9844 1225.3594,420.8438 1225.7031,420.8438 C1226,420.8438 1226.2813,421 1226.4219,421.2344 C1226.5156,421.3906 1226.5313,421.5313 1226.5313,421.9688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="1242.75" y="430.1543">User</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1112.5" x2="1369.5" y1="442" y2="442"/><ellipse cx="1122.5" cy="453" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="70" x="1131.5" y="456.2104">Name string</text><ellipse cx="1122.5" cy="465.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="1131.5" y="469.0151">Authenticators</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="1217.5" y="469.0151">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="122" x="1242.5" y="469.0151">[string]*Authenticator</text><ellipse cx="1122.5" cy="478.6094" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="131" x="1131.5" y="481.8198">MasterPassword []byte</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1112.5" x2="1369.5" y1="488.4141" y2="488.4141"/><ellipse cx="1122.5" cy="499.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="1131.5" y="502.6245">WebAuthID() []byte</text><ellipse cx="1122.5" cy="512.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="1131.5" y="515.4292">WebAuthName() string</text><ellipse cx="1122.5" cy="525.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="1131.5" y="528.2339">WebAuthDisplayName() string</text><!--MD5=[b09b053380024f3acc5da766a1030a4f]
class main.UserRequest--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="60.8047" id="main.UserRequest" style="stroke: #A80036; stroke-width: 1.5;" width="113" x="601.5" y="665.5"/><ellipse cx="616.5" cy="681.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M620.7813,677.4688 L620.7813,678.9688 C620.7813,679.4375 620.75,679.5781 620.6406,679.75 C620.4688,679.9688 620.2188,680.1094 619.9531,680.1094 C619.7188,680.1094 619.4844,680 619.3438,679.875 C619.2188,679.7344 619.2188,679.7344 619.1094,679.1875 C618.9531,678.5156 618.1406,678.0469 617.0781,678.0469 C616.0156,678.0469 615.1563,678.6094 615.1563,679.3438 C615.1563,679.7031 615.4219,680.0938 615.7969,680.2813 C616.125,680.4531 616.2188,680.4844 617.4844,680.7188 C618.9688,680.9844 619.6094,681.2344 620.1406,681.6563 C620.8281,682.2031 621.1406,682.8906 621.1406,683.7813 C621.1406,685.5469 619.5781,686.7344 617.25,686.7344 C616.3281,686.7344 615.4375,686.5156 614.5938,686.0781 C614.3125,686.4219 614.1875,686.4844 613.9219,686.4844 C613.3281,686.4844 613.0469,686.125 613.0469,685.3594 L613.0469,684.2344 C613.0469,683.8125 613.0938,683.625 613.2031,683.4531 C613.375,683.2344 613.625,683.1094 613.9063,683.1094 C614.1406,683.1094 614.3594,683.2031 614.5156,683.3594 C614.6406,683.4688 614.6406,683.4688 614.7656,683.9375 C614.9375,684.5469 616.0156,685.0313 617.1406,685.0313 C618.3906,685.0313 619.375,684.4844 619.375,683.75 C619.375,683.3906 619.1406,683.0469 618.7656,682.8438 C618.4063,682.6563 618.1406,682.5938 616.9844,682.3906 C615.875,682.2031 615.3281,682.0313 614.7813,681.7188 C613.9219,681.2344 613.3906,680.3281 613.3906,679.3594 C613.3906,677.6406 614.9688,676.3438 617.0781,676.3438 C617.9531,676.3438 618.7031,676.5313 619.2969,676.9063 C619.4688,676.4844 619.6094,676.3438 619.9531,676.3438 C620.25,676.3438 620.5313,676.5 620.6719,676.7344 C620.7656,676.8906 620.7813,677.0313 620.7813,677.4688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="81" x="630.5" y="685.6543">UserRequest</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="602.5" x2="713.5" y1="697.5" y2="697.5"/><ellipse cx="612.5" cy="708.5" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="70" x="621.5" y="711.7104">Name string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="602.5" x2="713.5" y1="718.3047" y2="718.3047"/><!--MD5=[4afa7547baef3e007f7a0e8f374e9984]
class main.UsernamePasswordRequest--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="73.6094" id="main.UsernamePasswordRequest" style="stroke: #A80036; stroke-width: 1.5;" width="208" x="750" y="659"/><ellipse cx="765" cy="675" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M769.2813,670.9688 L769.2813,672.4688 C769.2813,672.9375 769.25,673.0781 769.1406,673.25 C768.9688,673.4688 768.7188,673.6094 768.4531,673.6094 C768.2188,673.6094 767.9844,673.5 767.8438,673.375 C767.7188,673.2344 767.7188,673.2344 767.6094,672.6875 C767.4531,672.0156 766.6406,671.5469 765.5781,671.5469 C764.5156,671.5469 763.6563,672.1094 763.6563,672.8438 C763.6563,673.2031 763.9219,673.5938 764.2969,673.7813 C764.625,673.9531 764.7188,673.9844 765.9844,674.2188 C767.4688,674.4844 768.1094,674.7344 768.6406,675.1563 C769.3281,675.7031 769.6406,676.3906 769.6406,677.2813 C769.6406,679.0469 768.0781,680.2344 765.75,680.2344 C764.8281,680.2344 763.9375,680.0156 763.0938,679.5781 C762.8125,679.9219 762.6875,679.9844 762.4219,679.9844 C761.8281,679.9844 761.5469,679.625 761.5469,678.8594 L761.5469,677.7344 C761.5469,677.3125 761.5938,677.125 761.7031,676.9531 C761.875,676.7344 762.125,676.6094 762.4063,676.6094 C762.6406,676.6094 762.8594,676.7031 763.0156,676.8594 C763.1406,676.9688 763.1406,676.9688 763.2656,677.4375 C763.4375,678.0469 764.5156,678.5313 765.6406,678.5313 C766.8906,678.5313 767.875,677.9844 767.875,677.25 C767.875,676.8906 767.6406,676.5469 767.2656,676.3438 C766.9063,676.1563 766.6406,676.0938 765.4844,675.8906 C764.375,675.7031 763.8281,675.5313 763.2813,675.2188 C762.4219,674.7344 761.8906,673.8281 761.8906,672.8594 C761.8906,671.1406 763.4688,669.8438 765.5781,669.8438 C766.4531,669.8438 767.2031,670.0313 767.7969,670.4063 C767.9688,669.9844 768.1094,669.8438 768.4531,669.8438 C768.75,669.8438 769.0313,670 769.1719,670.2344 C769.2656,670.3906 769.2813,670.5313 769.2813,670.9688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="176" x="779" y="679.1543">UsernamePasswordRequest</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="751" x2="957" y1="691" y2="691"/><ellipse cx="761" cy="702" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="770" y="705.2104">Username string</text><ellipse cx="761" cy="714.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="770" y="718.0151">Password string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="751" x2="957" y1="724.6094" y2="724.6094"/><!--MD5=[2b0e4f6fea933f2bf19765accf9a2850]
class main.UsernameRequest--><rect fill="#FEFECE" filter="url(#f1pxjiugddcy9e)" height="60.8047" id="main.UsernameRequest" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="993" y="665.5"/><ellipse cx="1008" cy="681.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1012.2813,677.4688 L1012.2813,678.9688 C1012.2813,679.4375 1012.25,679.5781 1012.1406,679.75 C1011.9688,679.9688 1011.7188,680.1094 1011.4531,680.1094 C1011.2188,680.1094 1010.9844,680 1010.8438,679.875 C1010.7188,679.7344 1010.7188,679.7344 1010.6094,679.1875 C1010.4531,678.5156 1009.6406,678.0469 1008.5781,678.0469 C1007.5156,678.0469 1006.6563,678.6094 1006.6563,679.3438 C1006.6563,679.7031 1006.9219,680.0938 1007.2969,680.2813 C1007.625,680.4531 1007.7188,680.4844 1008.9844,680.7188 C1010.4688,680.9844 1011.1094,681.2344 1011.6406,681.6563 C1012.3281,682.2031 1012.6406,682.8906 1012.6406,683.7813 C1012.6406,685.5469 1011.0781,686.7344 1008.75,686.7344 C1007.8281,686.7344 1006.9375,686.5156 1006.0938,686.0781 C1005.8125,686.4219 1005.6875,686.4844 1005.4219,686.4844 C1004.8281,686.4844 1004.5469,686.125 1004.5469,685.3594 L1004.5469,684.2344 C1004.5469,683.8125 1004.5938,683.625 1004.7031,683.4531 C1004.875,683.2344 1005.125,683.1094 1005.4063,683.1094 C1005.6406,683.1094 1005.8594,683.2031 1006.0156,683.3594 C1006.1406,683.4688 1006.1406,683.4688 1006.2656,683.9375 C1006.4375,684.5469 1007.5156,685.0313 1008.6406,685.0313 C1009.8906,685.0313 1010.875,684.4844 1010.875,683.75 C1010.875,683.3906 1010.6406,683.0469 1010.2656,682.8438 C1009.9063,682.6563 1009.6406,682.5938 1008.4844,682.3906 C1007.375,682.2031 1006.8281,682.0313 1006.2813,681.7188 C1005.4219,681.2344 1004.8906,680.3281 1004.8906,679.3594 C1004.8906,677.6406 1006.4688,676.3438 1008.5781,676.3438 C1009.4531,676.3438 1010.2031,676.5313 1010.7969,676.9063 C1010.9688,676.4844 1011.1094,676.3438 1011.4531,676.3438 C1011.75,676.3438 1012.0313,676.5 1012.1719,676.7344 C1012.2656,676.8906 1012.2813,677.0313 1012.2813,677.4688 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="116" x="1022" y="685.6543">UsernameRequest</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="994" x2="1140" y1="697.5" y2="697.5"/><ellipse cx="1004" cy="708.5" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="1013" y="711.7104">Username string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="994" x2="1140" y1="718.3047" y2="718.3047"/><!--MD5=[8d4e739165650c477b7a9c6e7222f2b6]
reverse link main.StorageInterface to main.Storage--><path d="M265.242,306.09 C267.066,319.347 268.914,332.779 270.728,345.96 " fill="none" id="main.StorageInterface&lt;-main.Storage" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="258.292,306.929,262.5,286.161,272.161,305.02,258.292,306.929" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[569ec7877b11fc92aeb10c01695d5e4b]
link main.Authenticator to main.AuthnHandler--><!--MD5=[fe14efcd3ab332f77351ebe96b11bb69]
link main.AuthnHandler to main.CRUDHandler--><!--MD5=[4648ee4e8c9277867429faf41302a724]
link main.CRUDHandler to main.FileServer--><!--MD5=[127e9fb7f2631d4945be54b22af5cd23]
link main.Authenticator to main.GetPasswordRequest--><!--MD5=[5b7f39859498c4f2ee8f882699750120]
link main.GetPasswordRequest to main.Password--><!--MD5=[57a8a34f1661059b5d9b74a545a6c9b8]
link main.Password to main.PasswordRequest--><!--MD5=[4b6dc190621cee89d6433ca1af4d2a7e]
link main.PasswordRequest to main.User--><!--MD5=[8de36963c3517138e773ef6e0c903dda]
link main.GetPasswordRequest to main.UserRequest--><!--MD5=[4a347a8a5133530f7ce8e63c905d110d]
link main.UserRequest to main.UsernamePasswordRequest--><!--MD5=[ac6846f8232a2e7344ced6f4c8af935f]
link main.UsernamePasswordRequest to main.UsernameRequest--><!--MD5=[1330c41d5d0f64feae061efa72eed1a3]
@startuml
namespace main {
    class Authenticator << (S,Aquamarine) >> {
        + User *User
        + ID []byte
        + CredentialID []byte
        + PublicKey []byte
        + AAGUID []byte
        + SignCount uint32

        + WebAuthID() []byte
        + WebAuthCredentialID() []byte
        + WebAuthPublicKey() []byte
        + WebAuthAAGUID() []byte
        + WebAuthSignCount() uint32

    }
    class AuthnHandler << (S,Aquamarine) >> {
        - sessionName string
        - authn *webauthn.WebAuthn
        - cookieStore *sessions.CookieStore
        - storage StorageInterface
        - securityTokenName string
        - userFieldName string
        - cookieSessionName string

        - startRegistration(writer http.ResponseWriter, request *http.Request) 
        - finishRegistration(writer http.ResponseWriter, request *http.Request) 
        - startLogin(writer http.ResponseWriter, request *http.Request) 
        - finishLogin(writer http.ResponseWriter, request *http.Request) 
        - standardLogin(writer http.ResponseWriter, request *http.Request) 
        - standardRegister(writer http.ResponseWriter, request *http.Request) 
        - logout(writer http.ResponseWriter, request *http.Request) 

    }
    class CRUDHandler << (S,Aquamarine) >> {
        - cookieStore *sessions.CookieStore
        - storage StorageInterface

        + GetPassword(writer http.ResponseWriter, request *http.Request) 
        + AddPassword(writer http.ResponseWriter, request *http.Request) 
        + RemovePassword(writer http.ResponseWriter, request *http.Request) 
        + RemoveUser(writer http.ResponseWriter, request *http.Request) 
        + UpdateUser(writer http.ResponseWriter, request *http.Request) 
        + GetUser(writer http.ResponseWriter, request *http.Request) 

    }
    class FileServer << (S,Aquamarine) >> {
        - baseDir string
        - cookieStore *sessions.CookieStore
        - sessionName string
        - cookieName string
        - storage *Storage
        - userFieldName string

        + Router *mux.Router

        + ServeFileWithoutCheck(writer http.ResponseWriter, request *http.Request) 

    }
    class GetPasswordRequest << (S,Aquamarine) >> {
        + PasswordIdentifier string

    }
    class Password << (S,Aquamarine) >> {
        + Password string
        + Id string

    }
    class PasswordRequest << (S,Aquamarine) >> {
        + Password string
        + Id string

    }
    class Storage << (S,Aquamarine) >> {
        - users <font color=blue>map</font>[string]*User
        - authenticators <font color=blue>map</font>[string]*Authenticator

        + AddAuthenticator(user webauthn.User, authenticator webauthn.Authenticator) error
        + GetAuthenticator(id []byte) (webauthn.Authenticator, error)
        + GetUser(webauthnID string) *User
        + GetAuthenticators(user webauthn.User) ([]webauthn.Authenticator, error)
        + GetSessionKeyForUser(user *User) []byte
        + SetSessionKeyForUser(user *User, b []byte) error
        + DeleteSessionKeyForUser(user *User) error
        + AddUser(u *User) error
        + RemoveUser(u *User) error
        + UpdateUser(u *User) error
        + AddPassword(u *User, st string, p *Password) error
        + GetPassword(u *User, st string) (*Password, error)
        + UpdatePassword(u *User, st string, p *Password) error
        + DeletePassword(u *User, st string) error

    }
    interface StorageInterface  {
        + AddAuthenticator( webauthn.User,  webauthn.Authenticator) error
        + GetAuthenticator( []byte) (webauthn.Authenticator, error)
        + GetAuthenticators( webauthn.User) ([]webauthn.Authenticator, error)
        + GetUser(webauthnID string) *User
        + AddUser( *User) error
        + RemoveUser( *User) error
        + UpdateUser( *User) error
        + GetSessionKeyForUser( *User) []byte
        + SetSessionKeyForUser( *User,  []byte) error
        + DeleteSessionKeyForUser( *User) error
        + GetPassword( *User,  string) (*Password, error)
        + AddPassword( *User,  string,  *Password) error
        + UpdatePassword( *User,  string,  *Password) error
        + DeletePassword( *User,  string) error

    }
    class User << (S,Aquamarine) >> {
        + Name string
        + Authenticators <font color=blue>map</font>[string]*Authenticator
        + MasterPassword []byte

        + WebAuthID() []byte
        + WebAuthName() string
        + WebAuthDisplayName() string

    }
    class UserRequest << (S,Aquamarine) >> {
        + Name string

    }
    class UsernamePasswordRequest << (S,Aquamarine) >> {
        + Username string
        + Password string

    }
    class UsernameRequest << (S,Aquamarine) >> {
        + Username string

    }
}

"main.StorageInterface" <|- - "main.Storage"
@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>